# 비트레이트 계산 업데이트 (2025-07-16)

## 문제점
- 일반 모드: 4.1 Gbps 표시 (실제 표준: 165.17 Mbps)
- 프록시 모드: 435 Mbps 표시 (실제 표준: 30 Mbps)
- 원인: 압축되지 않은 raw 프레임 데이터 크기 계산

## 해결 방법
프레임 데이터 크기 기반 계산에서 NDI 기술 문서 표준값 사용으로 변경

### 구현 내용

#### 1. NDI 표준 비트레이트 메서드 추가
```python
def _get_ndi_standard_bitrate(self, width, height, fps):
    """NDI 기술 문서 기반 표준 비트레이트 반환 (Mbps)"""
```

#### 2. 프록시 모드 비트레이트 테이블
| 해상도 | 60fps | 30fps |
|--------|-------|-------|
| 640x360 | 30 Mbps | 15 Mbps |
| 960x540 | 50 Mbps | 30 Mbps |
| 1280x720 | 80 Mbps | 60 Mbps |
| 1920x1080 | 120 Mbps | 100 Mbps |
| 4K | 250 Mbps | 200 Mbps |

#### 3. 일반 모드 비트레이트 테이블
| 해상도 | 60fps | 30fps |
|--------|-------|-------|
| 1280x720 | 80 Mbps | 45 Mbps |
| 1920x1080 | **165.17 Mbps** | 85 Mbps |
| 2560x1440 | 250 Mbps | 130 Mbps |
| 3840x2160 | 450 Mbps | 250 Mbps |

### 제거된 코드
- `_get_frame_data_size()` 메서드
- `frame_data_window` deque
- 프레임 크기 기반 이동 평균 계산
- 오디오/메타데이터 프레임 크기 계산

### 장점
1. **정확성**: NDI 공식 문서 기준값 사용
2. **단순성**: 복잡한 계산 로직 제거
3. **성능**: 불필요한 데이터 처리 제거
4. **일관성**: 모든 시스템에서 동일한 값 표시

## 기술적 배경
- NDI SDK는 압축된 네트워크 비트레이트 정보를 제공하지 않음
- 수신된 프레임은 이미 디코딩된 상태
- SpeedHQ/H.264 압축률은 콘텐츠에 따라 가변적
- 따라서 표준값 사용이 가장 합리적인 접근

## 참고
- NDI 공식 문서: https://docs.ndi.video/all/getting-started/white-paper/bandwidth/
- FHD 60fps 표준: 165.17 Mbps (일반), 최대 120 Mbps (프록시)