# 비트레이트 계산 구현 요약

## 구현 내용

### 1. 프레임 데이터 기반 계산 방식 적용
- NDI SDK의 `line_stride_in_bytes`를 사용하여 실제 프레임 메모리 크기 측정
- 비디오, 오디오, 메타데이터 모든 프레임 타입의 크기를 합산
- `_get_frame_data_size()` 메서드로 각 프레임 타입별 크기 계산

### 2. 이동 평균(Moving Average) 구현
- `collections.deque`를 사용한 2초 윈도우 이동 평균
- 현재 FPS에 맞게 윈도우 크기 동적 조정
- 시간 범위 내의 유효한 프레임만 사용하여 정확도 향상

### 3. 제거된 코드
- 기존의 NDI 표준 비트레이트 추정 코드 제거
- 하드코딩된 비트레이트 값 대신 실측값 사용

## 주요 변경사항

### ndi_receiver.py
1. `__init__` 메서드에 누락된 변수 초기화 추가:
   - `self.bitrate_calc_start_time = 0`
   - `self.total_bytes_received = 0`

2. 비디오 프레임 처리 부분:
   - 프레임 크기를 deque에 추가
   - 1초마다 이동 평균 계산하여 비트레이트 업데이트

3. 오디오/메타데이터 프레임 처리:
   - 각 프레임 타입의 크기도 비트레이트 계산에 포함

## 예상 결과
- 실제 프레임 데이터 크기 기반의 보다 정확한 비트레이트 표시
- 프록시 모드: ~20-50 Mbps (압축되지 않은 데이터 기준)
- 일반 모드: ~400-800 Mbps (압축되지 않은 데이터 기준)

## 참고사항
- 표시되는 비트레이트는 압축되지 않은 프레임 데이터 크기 기준
- 실제 네트워크 전송량은 NDI 압축에 의해 더 낮을 수 있음
- NDI SDK가 실제 네트워크 비트레이트를 제공하지 않는 한계는 여전히 존재