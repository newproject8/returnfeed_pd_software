# 리턴피드 통합 소프트웨어 개발 가이드라인

## 프로젝트 개요

리턴피드 통합 소프트웨어는 방송 제작을 위한 전문가급 올인원 솔루션입니다. NDI 프리뷰, vMix Tally, SRT 스트리밍을 하나의 통합 애플리케이션으로 제공하며, 전 스태프 대상 초고속 PGM/탈리 신호 공유 기능을 포함합니다.

## 최근 업데이트 (v2.3 - 2025.07.16)

- **프로페셔널 UI 리디자인**: Adobe Premiere 스타일의 다크 테마
- **동적 비트레이트 계산**: NDI 실제 압축률 기반 대역폭 표시
- **컴팩트 1행 레이아웃**: 효율적인 공간 활용을 위한 단일행 컨트롤
- **브랜드 아이덴티티 강화**: 리턴피드 로고 통합 (타이틀바, 팝업, 상단바)
- **고정폭 시계 표시**: Monospace 폰트로 안정적인 시간 표시
- **고유 스트림 URL 공유**: 스태프들이 웹브라우저로 실시간 PGM/탈리 신호 접근
- **스마트 포커스 시스템**: NDI 소스 미선택 시 자동 포커스 및 애니메이션
- **성능 최적화**: 프록시 모드 프레임 보간으로 60fps 안정성 향상

## 핵심 아키텍처 원칙

### 1. 모듈 독립성
- 각 모듈(NDI, vMix, SRT)은 독립적으로 동작 가능
- 한 모듈의 오류가 다른 모듈에 영향을 주지 않도록 격리
- 명확한 인터페이스와 시그널/슬롯 통신

### 2. UI/UX 일관성
- **Adobe Premiere 스타일**: 전문가용 방송 소프트웨어 디자인
- **컴팩트 1행 레이아웃**: 모든 컨트롤을 한 눈에 볼 수 있는 효율적 구조
- **브랜드 통합**: 리턴피드 로고와 컬러 스키마 일관성
- **직관적 피드백**: 상태 변화 시 즉각적인 시각적 피드백

### 3. 성능 최적화
- **60fps 안정성**: 프록시/일반 모드 모두 부드러운 60fps 유지
- **동적 비트레이트**: 실제 압축률 기반 정확한 대역폭 계산
- **스마트 버퍼링**: 프레임 보간으로 끊김 없는 재생
- **메모리 효율성**: 적절한 큐 관리와 리소스 정리

## 개발 워크플로우

### 연구 → 계획 → 구현
1. **연구**: 기존 코드베이스 탐색, 패턴 이해
2. **계획**: 상세한 구현 계획 수립 및 검증
3. **구현**: 검증 체크포인트와 함께 실행

### 주요 검증 포인트
- 완전한 기능 구현 후
- 새로운 주요 컴포넌트 시작 전
- 문제 발생 시
- "완료" 선언 전

### 코드 품질 기준
- PyQt6 기반 통일된 코드베이스
- 타입 힌트 사용
- 명확한 에러 처리
- 적절한 로깅

## 프로젝트 구조

```
returnfeed_unified/
├── main_v2.py                    # 메인 실행 파일
├── modules/                      # 핵심 기능 모듈
│   ├── ndi_module/              # NDI 처리 (프리뷰, 비트레이트 계산)
│   ├── vmix_module/             # vMix Tally 시스템
│   └── srt_module/              # SRT 스트리밍
├── ui/                          # GUI 인터페이스
│   └── classic_mode/            # Adobe Premiere 스타일 UI
│       ├── components/          # UI 컴포넌트들
│       └── styles/              # 테마 및 스타일
├── network/                     # 네트워크 통신
├── utils/                       # 유틸리티 함수
└── resource/                    # 리소스 파일 (로고, 아이콘)
```

## UI 컴포넌트 가이드라인

### Command Bar (상단)
- 로그인 프레임
- 연결 상태 표시 (NDI, vMix, 리턴피드 스트림)
- 실시간 PGM/PVW Tally 표시
- 고정폭 시계
- 리턴피드 로고

### Video Display (중앙)
- 16:9 비율 고정 프리뷰
- 60fps NDI 프리뷰
- 오버레이 정보 표시
- 풀스크린 지원

### NDI Control Panel (컨트롤)
- 1행 레이아웃: `NDI | 소스선택 | 프록시/일반 | 연결해제 | 재탐색`
- 스마트 포커스 시스템
- 동적 비트레이트 표시

### Stream Control Panel (컨트롤)
- 1행 레이아웃: `리턴피드 | 서버상태 | 스트리밍 | 고유URL | 복사`
- 상태 기반 색상 변경
- 클릭 복사 기능

### Info Status Bar (하단)
- 해상도, FPS, 비트레이트
- CPU, 메모리 사용률
- 실시간 성능 모니터링

## 핵심 기능 구현 가이드

### NDI 처리
- **동적 비트레이트 계산**: 실제 프레임 크기 기반 압축률 감지
- **프록시 모드 최적화**: 프레임 보간으로 60fps 유지
- **자동 회전 보정**: vMix NDI 90도 회전 자동 처리

### vMix Tally
- **실시간 TCP 연결**: 8.3ms 평균 응답시간
- **WebSocket 브로드캐스트**: 실시간 상태 공유
- **자동 재연결**: 네트워크 끊김 시 자동 복구

### 스트림 URL 공유
- **고유 주소 생성**: 스태프별 고유 스트림 URL 자동 생성
- **상태 기반 UI**: 스트리밍 상태에 따른 색상 변경
- **클릭 복사**: URL 클릭 시 자동 클립보드 복사

### 스마트 포커스 시스템
- **자동 포커스**: NDI 소스 미선택 시 자동 포커스 이동
- **애니메이션 피드백**: 회전하는 빛 효과로 필요 액션 안내
- **사용자 경험**: 직관적인 워크플로우 가이드

## 성능 최적화 전략

### 60fps 안정성
- 16ms 정확한 타이밍 타이머
- 프레임 큐 관리로 안정적 버퍼링
- 프록시 모드 프레임 보간

### 메모리 관리
- 적절한 프레임 큐 크기 조절
- 스트리밍 시 불필요한 프레임 처리 생략
- 리소스 자동 정리

### CPU 효율성
- 스레드 우선순위 관리
- 이벤트 기반 아키텍처
- 필요시에만 렌더링

## 테스트 및 검증

### 기능 테스트
- 각 모듈 독립 실행 테스트
- 통합 환경 동시 실행 테스트
- 에러 상황 시뮬레이션

### 성능 테스트
- 60fps 안정성 검증
- 메모리 누수 검사
- CPU 사용률 최적화

### 사용자 테스트
- 직관적 UI 워크플로우
- 스마트 포커스 동작
- 애니메이션 피드백 효과

## 브랜드 가이드라인

### 로고 사용
- 타이틀바: `returnfeed_리턴피드_로고.png`
- 팝업 다이얼로그: 동일 로고 사용
- 상단바: `returnfeed_리턴피드_공식로고_타이포포함_흰색타이포.png`

### 색상 스키마
- Adobe Premiere 스타일 다크 테마
- 상태별 색상: 성공(녹색), 에러(빨간색), 비활성(회색)
- 브랜드 컬러 일관성 유지

## 문제 해결 가이드

### 일반적인 문제
1. **NDI 소스 미표시**: 방화벽 설정 확인
2. **vMix Tally 반응 없음**: API 활성화 확인
3. **GUI 끊김**: 프레임 스킵 설정 확인
4. **스트림 URL 접근 불가**: 네트워크 설정 확인

### 디버깅 도구
- 실시간 성능 모니터링
- 상세 로그 시스템
- 컴포넌트별 상태 표시

## 향후 개발 방향

### v2.4 계획
- 4K 해상도 지원
- 다중 NDI 소스 동시 프리뷰
- 웹 인터페이스 고도화
- 클라우드 백업 시스템

### 장기 비전
- 완전한 방송 제작 통합 솔루션
- 실시간 협업 도구
- AI 기반 자동화 기능

---

**리턴피드 통합 소프트웨어 v2.3**  
고성능 · 안정성 · 실시간 반응을 모두 갖춘 방송 제작 솔루션  
© 2025 ReturnFeed. All rights reserved.